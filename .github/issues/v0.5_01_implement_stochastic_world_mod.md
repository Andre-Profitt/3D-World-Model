# [TASK] Implement Stochastic World Model

Labels: task, enhancement, v0.5, uncertainty

---

## Task: Create Probabilistic Dynamics Model

**Milestone:** v0.5
**Section:** Stochastic Dynamics
**Estimated Time:** 6 hours
**Priority:** P0

### Specification
Implement world model that outputs distributions over next states and rewards.

### Implementation Checklist

#### Code Changes
- [ ] Create `models/stochastic_world_model.py`
- [ ] Output μ and log(σ²) for latent states
- [ ] Output μ and log(σ²) for rewards
- [ ] Implement reparameterization trick
- [ ] Add NLL loss function

#### Model Architecture
```python
class StochasticLatentWorldModel(nn.Module):
    def forward(self, z, a):
        # Output size: 2 * latent_dim + 2 (mean and logvar for z and r)
        # Returns: mu_z, logvar_z, mu_r, logvar_r
```

#### Training Updates
- [ ] Modify training script for `--stochastic` mode
- [ ] Implement ELBO loss (reconstruction + KL)
- [ ] Add KL annealing schedule
- [ ] Track uncertainty metrics during training

#### MPC Integration
- [ ] Sample trajectories from distributions
- [ ] Propagate uncertainty through planning
- [ ] Implement risk metrics (CVaR, worst-case)

### Definition of Done
- [ ] Model trains with stable NLL loss
- [ ] Uncertainty estimates correlate with errors (ρ > 0.7)
- [ ] Risk-sensitive planning shows measurably safer behavior
- [ ] No mode collapse (reasonable variance values)
